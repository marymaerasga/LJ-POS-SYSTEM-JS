<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>{{.Title}}</title>

        <!--- Bootstrap CSS -->
        <link href="/static/lib/css/bootstrap.min.css" rel="stylesheet">
        <!--- Jquery UI -->
        <link href="/static/lib/jquery-ui.min.css" rel="stylesheet">
        <!--- Styles -->
        <link href="/static/css/styles.css" rel="stylesheet">
        <!--- Google Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300&family=Poppins:wght@300&display=swap" rel="stylesheet">
        <!--- Font Awesome -->
        <script src="https://kit.fontawesome.com/6fa6ee6fa5.js" crossorigin="anonymous"></script>
      </head>
    <body class="sb-nav-fixed">
        <nav class="sb-topnav navbar navbar-expand navbartop">
            <!-- Navbar Brand-->
            <a class="navbar-brand text-white text-bold ps-3 text-center" href="/dashboard">LJ TRADING POS</a>
            <!-- Sidebar Toggle-->
            <button type="button" class="btn btn-sm order-1 order-lg-0 me-4 me-lg-0 text-white" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
            <!-- Navbar Search-->
            <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                <div class="searchdiv">
                    <input type="text" placeholder="Search ..." style="
                        width: 15rem;
                        outline: none;
                        border: none;
                        text-indent: 10px;
                        font-family: 'Poppins', sans-serif;
                        font-weight: bold;
                        height: 2.5rem;
                        font-size: 1rem;
                        border-radius: 5rem 0rem 0rem 5rem;
                        background-color: #f8fbfc;
                        text-transform: capitalize;">
                      <button style="
                        width: 3rem;
                        outline: none;
                        border: none;
                        height: 2.5rem;
                        border-radius: 0rem 5rem 5rem 0rem;
                        background-color: #f8fbfc;
                        margin-left: -20px;">
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="16"
                          height="16"
                          fill="currentColor"
                          class="bi bi-search"
                          viewBox="0 0 16 16">
                          <path
                            d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                          />
                        </svg>
                    </button>
                 </div>
            </form>
            <!-- Navbar-->
            <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-white" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fas fa-user fa-fw"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="#!">Settings</a></li>
                        <li><a class="dropdown-item" href="#!">Activity Log</a></li>
                        <li><hr class="dropdown-divider" /></li>
                        <li><a class="dropdown-item" href="#!">Logout</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-left" id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <a class="nav-link" href="/dashboard">
                                <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                                Dashboard
                            </a>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseLayouts" aria-expanded="false" aria-controls="collapseLayouts">
                                <div class="sb-nav-link-icon"><i class="fas fa-columns"></i></div>
                                Product Inventory
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapseLayouts" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="/product">Product List</a>
                                    <a class="nav-link" href="#">Product Category</a>
                                    <a class="nav-link" href="#!">Stock In Entry</a>
                                    <a class="nav-link" href="#!">Stock In History</a>
                                    <a class="nav-link" href="#!">Product Stock Status</a>
                                    <a class="nav-link" href="#!">Vat and Discount</a>
                                </nav>
                            </div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapsePages" aria-expanded="false" aria-controls="collapseLayouts">
                                <div class="sb-nav-link-icon"><i class="fas fa-book-open"></i></div>
                                Manage Account
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapsePages" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="#!">Staff Account</a>
                                    <a class="nav-link" href="#!">Admin Account</a>
                                </nav>
                            </div>
                            <a class="nav-link" href="#!">
                                <div class="sb-nav-link-icon"><i class="fas fa-chart-area"></i></div>
                                Point of Sale (POS)
                            </a>
                        </div>
                    </div>

                </nav>
            </div>

            <!--Product Content-->
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid">
                        <h1 class="mt-4">Product Inventory</h1>
                        <ol class="breadcrumb ">
                            <li class="breadcrumb-item active">Product List</li>
                        </ol>
                        <hr style="height:3px;border-width:0;color:gray;background-color:gray">
                        <div class="container-fluid ">
                            <div class="card shadow">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-auto">
                                           <!--- Search -->
                                        <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                                            <div class="searchdiv">
                                                <input type="text" placeholder="Search product" style="
                                                    width: 19rem;
                                                    outline: none;
                                                    border: none;
                                                    text-indent: 10px;
                                                    font-family: 'Poppins', sans-serif;
                                                    font-weight: bold;
                                                    height: 2.5rem;
                                                    font-size: 1rem;
                                                    border-radius: 5rem 0rem 0rem 5rem;
                                                    background-color: #f8fbfc;
                                                    text-transform: capitalize;">
                                                  <button style="
                                                    width: 3rem;
                                                    outline: none;
                                                    border: none;
                                                    height: 2.5rem;
                                                    border-radius: 0rem 5rem 5rem 0rem;
                                                    background-color: #f8fbfc;
                                                    margin-left: -20px;">
                                                    <svg
                                                      xmlns="http://www.w3.org/2000/svg"
                                                      width="16"
                                                      height="16"
                                                      fill="currentColor"
                                                      class="bi bi-search"
                                                      viewBox="0 0 16 16">
                                                      <path
                                                        d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                                                      />
                                                    </svg>
                                                </button>
                                             </div>
                                        </form>
                                        </div>
                                        <div class="col-md-auto">
                                            <select class="form-select category" id="category">
                                                <option selected>All</option>
                                                <option value="1">Category 1</option>
                                                <option value="2">Category 2</option>
                                                <option value="3">Category 3</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6 pe-5 ">
                                            <div class="product_header d-grid d-md-flex mx-auto">
                                                <button class="btn text-white" type="button" style="background-color: #80190A;" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" onclick="Validate()">ADD PRODUCT</button>
                                                <button class="btn text-white" onclick="pull_out_expired()" type="button" style="background-color: #80190A;">PULL OUT EXPIRED</button>
                                                <button class="btn text-white" type="button" style="background-color: #80190A;">GENERATE REPORT</button>
                                            </div>
                                        </div>
                                        
                                      </div>
                                </div>
                              </div>
                        </div>
                    </div>
                        <!--- Product list display  -->
                        <div class="product" id="product">
                            <div class="container-fluid mt-3 px-4 text-center">
                                <div class="card shadow">
                                    <div class="card-body">
                                        <div class="row row-cols-1 row-cols-md-4 g-4" id="item_card">
                                            <!--- Item List Append Here -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

        <!--- Delete Item Modal  -->
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog modal-sm modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="staticBackdropLabel">Delete Item</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="container-sm">
                    <div class="tab-pane fade show active" id="pills-login" role="tabpanel" aria-labelledby="pills-login-tab" tabindex="0">
                        <input type="hidden" class="form-control" id="itemID_delete">
                        <div class="form-floating mb-3">
                            <div class="delete_nam">
                                <span>Are you sure to Delete <h3 id="delete_name"></h3></span>
                            </div>
                        </div>
                        <div class="mt-3">
                            <div class="delete_btn">
                                <a type="submit"  href="#" class="btn w-100 btn-block rounded text-white" style="background-color: #80190A;" onclick="Delete_Yes()">YES</a>
                                <a type="submit"  href="#" class="btn w-100 btn-block rounded text-white" style="background-color: #80190A;" onclick="Delete_No()">NO</a>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>

    <!--- Add/Edit Item Modal  -->
          <div class="modal fade" id="staticBackdrop1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
            <div class="modal-dialog modal-fullscreen-sm-down modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="staticBackdropLabel">Product Code: </h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="container">
                    <!-- INPUT FORM -->
                    <div class="tab-pane fade show active" id="pills-login" role="tabpanel" aria-labelledby="pills-login-tab" tabindex="0">
                        <input type="hidden" class="form-control" id="itemID">
                        <div class="form-floating mb-2">
                          <input type="text" class="form-control" id="name" placeholder="Name" required>
                          <label for="floatingInput">Product Name</label>
                        </div>
                        <div class="mb-2">
                            <select class="form-select " name="category" id="category" required>
                                <option value="">Select Category</option>
                                <option value="1">Category 1</option>
                                <option value="2">Category 2</option>
                                <option value="3">Category 3</option>
                            </select>
                        </div>
                        <div class="form-floating mb-2">
                            <textarea  class="form-control " id="description" placeholder="Description" style="height: 100px"></textarea>
                            <label for="description">Description</label>
                        </div>
                        <div class="mb-3">
                            <select class="form-select " name="size" id="size" required>
                                <option value="">Select Size</option>
                                <option value="1">Extra Small</option>
                                <option value="2">Small</option>
                                <option value="3">Medium</option>
                                <option value="4">Large</option>
                                <option value="5">Extra Large</option>
                            </select>
                        </div>
                        <div class="row mb-3">
                            <div class="col">
                                <div class="form-floating">
                                    <input type="number" class="form-control" id="price" placeholder="Prize">
                                    <label for="floatingInput">Price</label>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-floating">
                                    <input type="number" class="form-control" id="qty" placeholder="Quantity">
                                    <label for="floatingInput">Initial Stocks</label>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Expiration Date:</label>
                                <input type="text" class="form-control" id="expiration" placeholder="MM/YYYY">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="image" class="form-label">Upload Product Image:</label>
                            <input class="form-control" type="file" id="image">
                        </div>
                        <div class="mt-3">
                          <a type="submit" id="item_save" href="#" class="btn w-100 btn-block rounded text-white" style="background-color: #80190A;" onclick="Save()">ADD PRODUCT</a>
                          <a type="submit" id="item_edit" href="#" class="btn w-100 btn-block rounded text-white" style="background-color: #80190A;" onclick="Modify()">MODIFY</a>
                        </div>
                    </div>
                </div>
              </div>
            </div>
            </div>
          </div>
        <!--- JQuery -->
        <script src="/static/lib/jquery-3.6.1.min.js"></script>
        <!--- Popper JS -->
        <script src="/static/lib/popper.min.js"></script>
        <!--- Bootstrap JS -->
        <script src="/static/lib/js/bootstrap.min.js"></script>
        <!--- Sweet Alert -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <!--- JS -->
        <script src="/static/js/scripts.js"></script>

        <script src="https://code.jquery.com/jquery-3.6.1.min.js"
        integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
        <script type="text/javascript"
        src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    </body>
</html>

<script>
    function Save(){
     var   name = $("#name").val()
     var   description = $("#description").val()
     var   price = $("#price").val()
     var   quantity = $("#qty").val()
     var   size = $("#size").val()
     var   category = $("#category").val()
     var   image = $("#image").val()

     if ( name == "" || description == "" || price == "" || quantity == "" || size == "" || category == "" || image == ""){
       /*swal("Please Complete Required Details")*/
       alert("Please Complete Required Details")
     }else{
       $.ajax({
         url: "/api/item",
         data: {
           "name": name,
           "description":description,
           "price": price,
           "size": size,
           "category": category,
           "quantity":quantity,
         },
         success: function () {
            /*swal({
                title: "Item Added Successfully!",
                icon: "success",
              });*/
              alert("Item Added Successfully!")
         /*window.location.reload()*/
         }
       })
     }
   }
   $( document ).ready(function() {
    $("#item_card").empty()
    var size = ""
    $.get("/api/get_item", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        if (v.Size == 1){
            size = "Extra Small"
        }
        if (v.Size == 2){
            size = "Small"
        }
        if (v.Size == 3){
            size = "Medium"
        }
        if (v.Size == 4){
            size = "Large"
        }
        if (v.Size == 5){
            size = "Extra Large"
        }
        $("#item_card").append(`
        <div class="col">
        <div class="card border-danger mb-3 " style="max-width: 15rem">
        <img src="/static/assets/img/Product1.jpg" class="img-fluid" style="height: 200px;" alt="...">
        <div class="card-body">
        <h5 class="card-title bold">`+v.Name+`</h5>
        <p class="card-subtitle mb-2 text-muted">`+v.Description+`</p>
        <p class="card-subtitle mb-2 text-muted">`+size+`</p>
        <h4 class="card-text">P `+v.Price+`</h4>
        <button type=button class="btn profilebtn text-white" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" onclick="Update('`+v.ID+`')" style="background-color: #80190A;">Update</button>
        <button type=button class="btn profilebtn text-white" data-bs-toggle="modal" data-bs-target="#staticBackdrop" onclick="Delete('`+v.ID+`') " style="background-color: #80190A;">
        Delete
        </button>
    </div>
    </div>
</div>
        `)
    })
  })
});

function Validate(){
    $("#item_edit").hide()
    $("#item_save").show()
}

function Update(id){
    $("#item_save").hide()
    $("#item_edit").show()
    size = ""
    $.get("/api/get_item", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        if (id == v.ID){
     $("#itemID").val(v.ID)
     $("#name").val(v.Name)
     $("#description").val(v.Description)
     $("#price").val(v.Price)
     $("#qty").val(v.Quantity)
     $("#size").val(v.Size)
     $("#category").val(v.Category)
        }
    })
})
}

function Modify(){
    var   id = $("#itemID").val()
    var   name = $("#name").val()
     var   description = $("#description").val()
     var   price = $("#price").val()
     var   quantity = $("#qty").val()
     var   size = $("#size").val()
     var   category = $("#category").val()
     var   image = $("#image").val()

     if ( name == "" || description == "" || price == "" || quantity == "" || size == "" || category == "" || image == ""){
       /*swal("Please Complete Required Details")*/
       alert("Please Complete Required Details")
     }else{
       $.ajax({
         url: "/api/edit_item",
         data: {
            "id": id,
           "name": name,
           "description":description,
           "price": price,
           "size": size,
           "category": category,
           "quantity":quantity,
         },
         success: function () {
            /*swal({
                title: "Updated Item Successfully!",
                icon: "success",
              });*/
              alert("Updated Item Successfully!")
         /*window.location.reload()*/
         }
       })
     }
}

function Delete(id){
    $.get("/api/get_item", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        if (id == v.ID){
     $("#itemID_delete").val(v.ID)   
     $("#delete_name").html(v.Name)
        }
    })
})
}

function Delete_No(){
    window.location.reload()
}

function Delete_Yes(){
    var   id = $("#itemID_delete").val()
    $.ajax({
         url: "/api/delete_item",
         data: {
            "id": id,
         },
         success: function () {
           /* swal({
                title: "Deleted Item Successfully!",
                icon: "success",
              });*/
              alert("Deleted Item Successfully!")
         /*window.location.reload()*/
         }
       })
}

function pull_out_expired(){
    Swal.fire({
        text: "10 Products have been expired, Do you want to Pull Out all Expired products?",
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#80190A',
        cancelButtonColor: '#747474',
        confirmButtonText: 'Yes'
      }).then((result) => {
        if (result.isConfirmed) {
          Swal.fire(
            'Pulled Out!',
            'Products have been pull out.',
            'success'
          )
        }
      })
}
 </script>


 