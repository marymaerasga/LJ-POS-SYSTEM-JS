<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{.Title}}</title>
    <!--- Bootstrap CSS -->
    <link href="/static/lib/css/bootstrap.min.css" rel="stylesheet" />
    <!--- Styles -->
    <link href="/static/css/index.css" rel="stylesheet" />
    <!--- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap"
      rel="stylesheet"
    />
    <!--- Font Awesome -->
    <script
      src="https://kit.fontawesome.com/6fa6ee6fa5.js"
      crossorigin="anonymous"
    ></script>
    <!--- SweetAlert -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>
  </head>
  <body>
    <!--- Navbar -->
    <div class="navbar navbar-expand-lg sticky-top">
      <!--- Logo and Title Div -->
      <div class="div1">
        <img
          src="/static/assets/img/logo.png"
          alt="Logo"
          width="60rem"
          height="60rem"
        />
        <a class="navbar-brand text-white" href="#"
          >LJ MOTORGEAR TRADING POS SYSTEM</a
        >
      </div>
      <!--- Search, Category and Login btn Div -->
      <div class="div2">
        <!--- Search -->
        <div class="searchdiv">
          <input
            type="text"
            placeholder="Search product"
            id="searchdata"
            class="searchbox"
          />
          <button class="searchbutton" onclick="CatSearch()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-search"
              viewBox="0 0 16 16"
            >
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
              />
            </svg>
          </button>
        </div>
        <!---Category-->

        <select class="category" id="category"></select>
        <!--- Profile -->
        <button
          type="button"
          class="btn profilebtn"
          data-bs-toggle="modal"
          data-bs-target="#staticBackdrop"
        >
          <img
            class="text-white"
            alt="profileImg"
            width="40rem"
            height="40rem"
            src="/static/assets/img/user.png"
          />
        </button>
      </div>
    </div>

    <!--- Product list display  -->
    <div class="product" id="product">
      <div
        class="container-fluid mt-5 px-4 text-center"
        style="margin-right: -14px"
      >
        <div class="row row-cols-1 row-cols-md-4 g-4" id="item_card">
          <!--- Item List Append Here -->
        </div>
      </div>
    </div>
    <!--- Login modal  -->
    <div
      class="modal fade"
      id="staticBackdrop"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="staticBackdropLabel">
              Welcome to LJ POS!
            </h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="container-sm">
              <!-- Login Tab -->
              <div
                class="tab-pane fade show active"
                id="pills-login"
                role="tabpanel"
                aria-labelledby="pills-login-tab"
                tabindex="0"
              >
                <div class="form-floating mb-3">
                  <input
                    type="email"
                    class="form-control"
                    id="floatingInput"
                    placeholder="name@example.com"
                  />
                  <label for="floatingInput">Email address</label>
                </div>
                <div class="form-floating">
                  <input
                    type="password"
                    class="form-control"
                    id="floatingPassword"
                    placeholder="Password"
                  />
                  <label for="floatingPassword">Password</label>
                </div>
                <div class="mt-3">
                  <a
                    type="submit"
                    href="#"
                    class="btn w-100 btn-block rounded mb-2 text-white"
                    style="background-color: #80190a"
                    onclick="Login()"
                    >Login</a
                  >
                </div>
              </div>
              <!-- Login Tab -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--- JQuery -->
    <script src="/static/lib/jquery-3.6.1.min.js"></script>
    <!--- Popper JS -->
    <script src="/static/lib/popper.min.js"></script>
    <!--- Bootstrap JS -->
    <script src="/static/lib/js/bootstrap.min.js"></script>
    <!--- JS -->
    <script src="/static/js/index/app.js"></script>

    <script
      src="https://code.jquery.com/jquery-3.6.1.min.js"
      integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
      crossorigin="anonymous"
    ></script>
    <script
      type="text/javascript"
      src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"
    ></script>
  </body>

  <script>
    function Login() {
      var username = $("#floatingInput").val();
      var password = $("#floatingPassword").val();

      console.log(username, password);

      if (username == "" || password == "") {
        // use SweetAlert2 to show an error dialog
        Swal.fire({
          title: "Error!",
          text: "Please Complete Required Details",
          icon: "error",
          confirmButtonText: "OK",
        });
      } else {
        $.ajax({
          url: "/api/login",
          data: {
            username: username,
            password: password,
          },
          success: function (res) {
            var result = JSON.parse(res).results;

            if (result == 1) {
              // use SweetAlert2 to show a success dialog
              Swal.fire({
                title: "Success!",
                text: "Login Successfully!",
                icon: "success",
                confirmButtonText: "OK",
              }).then((result) => {
                if (result.isConfirmed) {
                  window.location.replace("/dash/dashboard");
                }
              });
            } else {
              // use SweetAlert2 to show an error dialog
              Swal.fire({
                title: "Error!",
                text: "Please Check your Email and Password!",
                icon: "error",
                confirmButtonText: "OK",
              });
            }
          },
        });
      }
    }

    $(document).ready(function () {
      $("#category").empty();
      $("#category").append(`
      <option value="0">Select All</option>
    `);
      $.get("/api/get_category", function (index) {
        var result = JSON.parse(index).item;
        $.each(result, function (_, v) {
          $("#category").append(
            `
      <option value="` +
              v.ID +
              `">` +
              v.Name +
              `</option>
    `
          );
        });
      });

      $("#item_card").empty();
      var size = "";
      $.get("/api/get_item", function (index) {
        var result = JSON.parse(index).item;
        $.each(result, function (_, v) {
          AppendData(v.Size, v.Name, v.Price, v.ID);
        });
      });
    });

    function AppendData(Size, Name, Price, ID) {
      var size = "";
      if (Size == 1) {
        size = "Extra Small";
      }
      if (Size == 2) {
        size = "Small";
      }
      if (Size == 3) {
        size = "Medium";
      }
      if (Size == 4) {
        size = "Large";
      }
      if (Size == 5) {
        size = "Extra Large";
      }
      $("#item_card").append(
        `
        <div class="col">
        <div class="card border-danger rounded-5 mb-3 " style="max-width: 15rem">
        <img src="/static/assets/img/Product1.jpg" class="img-fluid mx-auto mt-2" style="height: 100px; width:150px" alt="...">
        <div class="card-body">
        <h5 class="card-title bold">` +
          Name +
          `</h5>
        <p class="card-subtitle mb-2 text-muted">` +
          size +
          `</p>
        <h4 class="card-text">P ` +
          Price +
          `</h4>
    </div>
    </div>
    </div>
        `
      );
    }

    $("#category_search").change(function () {
      var search = $("#category").val();

      $("#item_card").empty();
      var size = "";
      $.get("/api/get_item", function (index) {
        var result = JSON.parse(index).item;
        $.each(result, function (_, v) {
          if (search == v.CategoryID) {
            AppendData(v.Size, v.Name, v.Price, v.ID);
          }
          if (search == 0) {
            AppendData(v.Size, v.Name, v.Price, v.ID);
          }
        });
      });
    });

    function CatSearch() {
      var search = $("#searchdata").val();
      $("#item_card").empty();
      var size = "";
      $.get("/api/get_item", function (index) {
        var result = JSON.parse(index).item;
        $.each(result, function (_, v) {
          if (search == v.Name) {
            AppendData(v.Size, v.Name, v.Price, v.ID);
          }
          if (search == "") {
            AppendData(v.Size, v.Name, v.Price, v.ID);
          }
        });
      });
    }
  </script>
</html>
