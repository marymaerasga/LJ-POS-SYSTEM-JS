{{define "title"}}
<title>{{.Title}}</title>
{{end}}

{{define "content"}}

            <!--Staff Account Content-->
            <div id="layoutSidenav_content">
                <main>
                    <div class="container-fluid">
                        <h1 class="mt-4">Manage Account</h1>
                        <ol class="breadcrumb ">
                            <li class="breadcrumb-item active">Staff Account</li>
                        </ol>
                        <hr style="height:3px;border-width:0;color:gray;background-color:gray">
                        <div class="container-fluid ">
                            <div class="card shadow">
                                <div class="card-body">
                                    <div class="row text-center">
                                        <div class="col-md-4">
                                            <div class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                                                <div class="searchdiv">
                                                    <input type="text" id="search-staff" placeholder="Search ..." style="
                                                        width: 17rem;
                                                        outline: none;
                                                        border: none;
                                                        text-indent: 10px;
                                                        font-family: 'Poppins', sans-serif;
                                                        font-weight: bold;
                                                        height: 2.5rem;
                                                        font-size: 1rem;
                                                        border-radius: 5rem 0rem 0rem 5rem;
                                                        background-color: #f8fbfc;
                                                        text-transform: capitalize;">
                                                      <button style="
                                                        width: 3rem;
                                                        outline: none;
                                                        border: none;
                                                        height: 2.5rem;
                                                        border-radius: 0rem 5rem 5rem 0rem;
                                                        background-color: #f8fbfc;
                                                        margin-left: -20px;" onclick="Search()">
                                                        <svg
                                                          xmlns="http://www.w3.org/2000/svg"
                                                          width="16"
                                                          height="16"
                                                          fill="currentColor"
                                                          class="bi bi-search"
                                                          viewBox="0 0 16 16">
                                                          <path
                                                            d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                                                          />
                                                        </svg>
                                                    </button>
                                                 </div>
                                                </div>

                                        </div>
                                        <div class="col-md-4">
                                            <div class="row">
                                                <div class="col-md-auto">
                                                    <label for="acc-status" class=" col-form-label">Account Status:</label>
                                                </div>
                                                <div class="col">
                                                    <select id="acc-status" class="form-select">
                                                        <option selected value="Active">ACTIVE</option>
                                                        <option value="Deactivate">DEACTIVATE</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col">
                                            <button class="btn text-white" id= "add-staff" type="button" data-bs-toggle="modal" data-bs-target="#staticBackdrop" style="background-color: #80190A;">CREATE NEW ACCOUNT</button>
                                        </div>
                                      </div>
                                </div>
                              </div>
                        </div>

                        <div class="container-fluid mt-3">
                            <div class="card shadow">
                                <!--- Tables -->
                            <div class="table-responsive py-3 ms-3 me-3">
                                <table class="table table-bordered text-center">
                                    <thead>
                                        <th scope="col">#</th>
                                        <th scope="col">First Name</th>
                                        <th scope="col">Last Name</th>
                                        <th scope="col">Sex</th>
                                        <th scope="col">Mobile No.</th>
                                        <th scope="col">Address</th>
                                        <th scope="col">Email Address</th>
                                        <th scope="col">Position</th>
                                        <th scope="col">Status</th>
                                        <th scope="col">Button</th>
                                    </thead>
                                    <tbody id="staff-details">
                                      
                                    </tbody>
                                  </table>
                            </div>
                            </div>
                        </div>
                    </div>
                    </main>
                </div>
            </div>

            <!---ADD STAFF MODAL--->
            <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" id="staticBackdropLabel">Create New Staff </h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <div class="container">
                        <!-- INPUT FORM -->
                        <div class="tab-pane fade show active" id="pills-login" role="tabpanel" aria-labelledby="pills-login-tab" tabindex="0">
                            <div class="form-floating mb-2">
                              <input type="text" class="form-control" id="firstname" placeholder="Name" required>
                              <label for="firstname">First Name</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="lastname" placeholder="Name" required>
                                <label for="lastname">Last Name</label>
                              </div>
                              <div class="form-floating mb-2">
                                <select id="sex" class="form-select">
                                    <option selected value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                                <label for="sex">Sex</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="mobile-no" placeholder="Mobile-No">
                                <label for="mobile-no">Mobile No.</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="address" placeholder="Address">
                                <label for="address">Address</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="email" class="form-control" id="email" placeholder="Email">
                                <label for="email">Email Address</label>
                            </div>

                            <div class="form-floating mb-2">
                                <input type="password" class="form-control" id="password" placeholder="Password">
                                <label for="password">Password</label>
                            </div>
                            <div class="form-floating mb-2">
                                <select id="position" class="form-select">
                                    <option selected value="Admin">Admin</option>
                                    <option value="User">User</option>
                                </select>
                                <label for="position">Position</label>
                            </div>
                            <div class="mt-3 mb-2" >
                                <a type="submit" id="staff_save" href="#" class="btn w-100 btn-block rounded text-white" style="background-color: #80190A;" onclick="Save()">Save</a>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
                </div>
              </div>

               <!---ADD STAFF MODAL--->
            <div class="modal fade" id="staticBackdrop1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5" id="staticBackdropLabel">Modify Staff </h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <div class="container">
                        <!-- INPUT FORM -->
                        <div class="tab-pane fade show active" id="pills-login" role="tabpanel" aria-labelledby="pills-login-tab" tabindex="0">
                            <input type="hidden" class="form-control" id="customerID">
                            <div class="form-floating mb-2">
                              <input type="text" class="form-control" id="firstname1" placeholder="Name" required>
                              <label for="firstname">First Name</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="lastname1" placeholder="Name" required>
                                <label for="lastname">Last Name</label>
                              </div>
                              <div class="form-floating mb-2">
                                <select id="sex1" class="form-select">
                                    <option selected value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                                <label for="sex">Sex</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="mobile-no1" placeholder="Mobile-No">
                                <label for="mobile-no">Mobile No.</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="text" class="form-control" id="address1" placeholder="Address">
                                <label for="address">Address</label>
                            </div>
                            <div class="form-floating mb-2">
                                <input type="email" class="form-control" id="email1" placeholder="Email">
                                <label for="email">Email Address</label>
                            </div>
                            <div class="form-floating mb-2">
                                <select id="position1" class="form-select">
                                    <option selected value="Admin">Admin</option>
                                    <option value="User">User</option>
                                </select>
                                <label for="position">Position</label>
                            </div>
                            <div class="form-floating mb-2">
                                <select id="status" class="form-select">
                                    <option selected value="Active">Active</option>
                                    <option value="Deactivate">Deactivate</option>
                                </select>
                                <label for="status">Status</label>
                            </div>
                            <div class="mt-3 mb-2" >
                                <a type="submit" id="staff_save" href="#" class="btn w-100 btn-block rounded text-white" style="background-color: #80190A;" onclick="Modify()">Modify</a>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
                </div>
              </div>

              
                                      <!-- - Delete Item Modal   -->
                                      <div class="modal fade" id="deleteModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
                                      aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                      <div class="modal-dialog modal-sm modal-dialog-centered">
                                          <div class="modal-content">
                                          <div class="modal-header">
                                              <h1 class="modal-title fs-5" id="staticBackdropLabel">Delete Item</h1>
                                              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                          </div>
                                          <div class="modal-body">
                                              <div class="container-sm">
                                              <div class="tab-pane fade show active" id="pills-login" role="tabpanel" aria-labelledby="pills-login-tab"
                                                  tabindex="0">
                                                  <input type="hidden" class="form-control" id="itemID_delete">
                                                  <input type="hidden" class="form-control" id="userID_delete">
                                                  <div class="form-floating mb-3">
                                                  <div class="delete_nam">
                                                      <span>Are you sure to Delete <h3 id="delete_name"></h3></span>
                                                  </div>
                                                  </div>
                                                  <div class="mt-3">
                                                  <div class="delete_btn">
                                                      <a type="submit" href="#" class="btn w-100 btn-block rounded text-white"
                                                      style="background-color: #80190A;" onclick="Delete_Yes()">YES</a>
                                                      <a type="submit" href="#" class="btn w-100 btn-block rounded text-white"
                                                      style="background-color: #80190A;" onclick="Delete_No()">NO</a>
                                                  </div>
  
                                                  </div>
                                              </div>
                                              </div>
                                          </div>
                                          </div>
                                      </div>
                                    </div>

<script>
      function Save(){
      var   fname = $("#firstname").val()
      var   lname = $("#lastname").val()
      var   sex = $("#sex").val()
      var   mobileNo = $("#mobile-no").val()
      var   address = $("#address").val()
      var   username = $("#email").val()
      var   password = $("#password").val()
      var   position = $("#position").val()
     
      if ( fname == "" || mobileNo == "" || address == "" || lname == "" || sex == "" || username == "" || password == "" || position == ""){
        /*swal("Please Complete Required Details")*/
        alert("Please Complete Required Details")
      }else{
        $.ajax({
          url: "/api/employee",
          data: {
            "fname": fname,
            "lname": lname,
            "sex": sex,
            "mobileNo":mobileNo,
            "address": address,
            "username": username,
            "password": password,
            "position": position,
          },
          success: function () {
             /*swal({
                 title: "Item Added Successfully!",
                 icon: "success",
               });*/
               alert("Customer Added Successfully!")
               window.location.reload()
          }
        })
      }
    }

    $( document ).ready(function() {
    $("tbody").empty()
    $.get("/api/get_employee", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        $("#staff-details").append(`
        <tr class="border">
            <td>`+v.ID+`</td>
            <td>`+v.User.FirstName+` </td>
            <td>`+v.User.LastName+`</td>
            <td>`+v.Sex+`</td>
            <td>`+v.MobileNo+`</td>
            <td>`+v.Address+` </td>
            <td>`+v.User.Username+`</td>
            <td>`+v.User.Position+`</td>
            <td>`+v.Status+`</td>
            <td>
                <button type="button" class="btn text-white text-center" id ="delete-category" data-bs-toggle="modal" data-bs-target="#deleteModal" style="background-color: #80190A;" onclick="Delete(`+v.ID+`)"><i class="fa-solid fa-trash"></i></button>
                <button type="button" class="btn text-white text-center" id ="edit-category" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" style="background-color: #80190A;" onclick="Edit(`+v.ID+`)"><i class="fa-solid fa-pen-to-square"></i></button>
            </td>
        </tr>
        `)
    })
    })
});

function Edit(id){
    $("tbody").empty()
    $.get("/api/get_employee", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        $("#customerID").val(id)
        $("#firstname1").val(v.User.FirstName)
       $("#lastname1").val(v.User.LastName)
       $("#sex1").val(v.Sex)
        $("#mobile-no1").val(v.MobileNo)
       $("#address1").val(v.Address)
      $("#email1").val(v.User.Username)
       $("#position1").val(v.User.Position)
    })
})
}

function Modify(){
    var   id = $("#customerID").val()
  var   fname = $("#firstname1").val()
      var   lname = $("#lastname1").val()
      var   sex = $("#sex1").val()
      var   mobileNo = $("#mobile-no1").val()
      var   address = $("#address1").val()
      var   username = $("#email1").val()
      var   status = $("#status").val()
      var   position = $("#position1").val()
     
      if ( fname == "" || mobileNo == "" || address == "" || lname == "" || sex == "" || username == "" || status == "" || position == ""){
        alert("Please Complete Required Details")
        }else{
        $.ajax({
            url: "/api/edit_employee",
            data: {
                "id": id,
            "fname": fname,
            "lname": lname,
            "sex": sex,
            "mobileNo":mobileNo,
            "address": address,
            "username": username,
            "status": status,
            "position": position,
            },
            success: function () {
            /*swal({
                title: "Updated Item Successfully!",
                icon: "success",
                });*/
                alert("Updated Item Successfully!")
            window.location.reload()
            }
        })
        }
}

function Delete(id){
  $.get("/api/get_employee", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
      if (id == v.ID){
        $("#userID_delete").val(v.User.ID)
       $("#itemID_delete").val(id)
      $("#delete_name").html(v.User.FirstName + v.User.LastName)

      }

    })
  })

}

function Delete_No(){
    window.location.reload()
}

function Delete_Yes(){
    var   id = $("#itemID_delete").val()
    var   uid = $("#userID_delete").val()
    $.ajax({
            url: "/api/delete_employee",
            data: {
            "id": id,
            "uid": uid,
            },
            success: function () {
            /* swal({
                title: "Deleted Item Successfully!",
                icon: "success",
                });*/
                alert("Deleted Item Successfully!")
            window.location.reload()
            }
        })
}

$("#acc-status").change(function () {   
var status = $("#acc-status").val()

$("tbody").empty()
    $.get("/api/get_employee", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        if(status == v.Status){
            $("#staff-details").append(`
            <tr class="border">
                <td>`+v.ID+`</td>
                <td>`+v.User.FirstName+` </td>
                <td>`+v.User.LastName+`</td>
                <td>`+v.Sex+`</td>
                <td>`+v.MobileNo+`</td>
                <td>`+v.Address+` </td>
                <td>`+v.User.Username+`</td>
                <td>`+v.User.Position+`</td>
                <td>`+v.Status+`</td>
                <td>
                    <button type="button" class="btn text-white text-center" id ="delete-category" data-bs-toggle="modal" data-bs-target="#deleteModal" style="background-color: #80190A;" onclick="Delete(`+v.ID+`)"><i class="fa-solid fa-trash"></i></button>
                    <button type="button" class="btn text-white text-center" id ="edit-category" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" style="background-color: #80190A;" onclick="Edit(`+v.ID+`)"><i class="fa-solid fa-pen-to-square"></i></button>
                </td>
            </tr>
            `)
        }
    })
    })

})

function Search(){
    var search = $("#search-staff").val()

    $("tbody").empty()
    $.get("/api/get_employee", function(index){
    var result = JSON.parse(index).item
    $.each(result, function(_,v){
        if(search == v.User.FirstName){
            $("#staff-details").append(`
            <tr class="border">
                <td>`+v.ID+`</td>
                <td>`+v.User.FirstName+` </td>
                <td>`+v.User.LastName+`</td>
                <td>`+v.Sex+`</td>
                <td>`+v.MobileNo+`</td>
                <td>`+v.Address+` </td>
                <td>`+v.User.Username+`</td>
                <td>`+v.User.Position+`</td>
                <td>`+v.Status+`</td>
                <td>
                    <button type="button" class="btn text-white text-center" id ="delete-category" data-bs-toggle="modal" data-bs-target="#deleteModal" style="background-color: #80190A;" onclick="Delete(`+v.ID+`)"><i class="fa-solid fa-trash"></i></button>
                    <button type="button" class="btn text-white text-center" id ="edit-category" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" style="background-color: #80190A;" onclick="Edit(`+v.ID+`)"><i class="fa-solid fa-pen-to-square"></i></button>
                </td>
            </tr>
            `)
        }
        if (search == "" || search == " "){
            $("#staff-details").append(`
            <tr class="border">
                <td>`+v.ID+`</td>
                <td>`+v.User.FirstName+` </td>
                <td>`+v.User.LastName+`</td>
                <td>`+v.Sex+`</td>
                <td>`+v.MobileNo+`</td>
                <td>`+v.Address+` </td>
                <td>`+v.User.Username+`</td>
                <td>`+v.User.Position+`</td>
                <td>`+v.Status+`</td>
                <td>
                    <button type="button" class="btn text-white text-center" id ="delete-category" data-bs-toggle="modal" data-bs-target="#deleteModal" style="background-color: #80190A;" onclick="Delete(`+v.ID+`)"><i class="fa-solid fa-trash"></i></button>
                    <button type="button" class="btn text-white text-center" id ="edit-category" data-bs-toggle="modal" data-bs-target="#staticBackdrop1" style="background-color: #80190A;" onclick="Edit(`+v.ID+`)"><i class="fa-solid fa-pen-to-square"></i></button>
                </td>
            </tr>
            `)
        }
    })
    })
}
</script>
{{end}}




 